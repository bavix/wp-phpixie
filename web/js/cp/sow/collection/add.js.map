{"version":3,"sources":["add.jsx"],"names":["$","submit","event","preventDefault","$self","form","FormData","fetch","attr","method","credentials","body","then","response","status","json","error","Error","statusText","location","href","id","catch","$message","find","length","prepend","addClass","text","message","select2","theme","ajax","url","dataType","delay","data","params","queries","name","term","page","processResults","results","map","obj","cache"],"mappings":";;AAAAA,EAAE,YAAY;;AAEVA,MAAE,gBAAF,EAAoBC,MAApB,CAA2B,UAAUC,KAAV,EAAiB;;AAExCA,cAAMC,cAAN;;AAEA,YAAIC,QAAQJ,EAAE,IAAF,CAAZ;AACA,YAAIK,OAAO,IAAIC,QAAJ,CAAa,IAAb,CAAX;;AAEAC,cAAMH,MAAMI,IAAN,CAAW,QAAX,CAAN,EAA4B;AACxBC,oBAAQL,MAAMI,IAAN,CAAW,QAAX,CADgB;AAExBE,yBAAa,SAFW;AAGxBC,kBAAMN;AAHkB,SAA5B,EAIGO,IAJH,CAIQ,UAAUC,QAAV,EAAoB;AACxB,gBAAIA,SAASC,MAAT,KAAoB,GAApB,IAA2BD,SAASC,MAAT,KAAoB,GAAnD,EAAwD;AACpD,uBAAOD,SAASE,IAAT,EAAP;AACH;;AAED,gBAAIC,QAAQ,IAAIC,KAAJ,CAAUJ,SAASK,UAAnB,CAAZ;AACAF,kBAAMH,QAAN,GAAiBA,QAAjB;AACA,kBAAMG,KAAN;AACH,SAZD,EAYGJ,IAZH,CAYQ,UAAUG,IAAV,EAAgB;;AAEpBI,qBAASC,IAAT,GAAgB,6BAA6BL,KAAKM,EAAlD;AAEH,SAhBD,EAgBGC,KAhBH,CAgBS,UAAUN,KAAV,EAAiB;AACtB,gBAAIO,WAAWnB,MAAMoB,IAAN,CAAW,QAAX,CAAf;;AAEA,gBAAI,CAACD,SAASE,MAAd,EAAsB;AAClBrB,sBAAMoB,IAAN,CAAW,iBAAX,EAA8BE,OAA9B,CAAsC,2BAAtC;AACAH,2BAAWnB,MAAMoB,IAAN,CAAW,QAAX,CAAX;AACH;;AAEDR,kBAAMH,QAAN,CAAeE,IAAf,GAAsBH,IAAtB,CAA2B,UAACG,IAAD;AAAA,uBAAUQ,SAASI,QAAT,CAAkB,cAAlB,EAAkCC,IAAlC,CAAuCb,KAAKc,OAA5C,CAAV;AAAA,aAA3B;AACH,SAzBD;AA2BH,KAlCD;;AAoCA7B,MAAE,eAAF,EAAmB8B,OAAnB,CAA2B;AACvBC,eAAO,WADgB;AAEvBC,cAAM;AACFC,iBAAK,yBADH;AAEFC,sBAAU,MAFR;AAGFC,mBAAO,GAHL;AAIFC,kBAAM,cAAUC,MAAV,EAAkB;AACpB,uBAAO;AACHC,6BAAS;AACLC,8BAAMF,OAAOG;AADR,qBADN;AAIHC,0BAAMJ,OAAOI,IAAP,IAAe;AAJlB,iBAAP;AAMH,aAXC;AAYFC,4BAAgB,wBAAUN,IAAV,EAAgB;AAC5B,oBAAI,OAAOA,KAAKP,OAAZ,KAAwB,WAA5B,EAAyC;AACrC,2BAAO;AACHc,iCAAS;AADN,qBAAP;AAGH;;AAED,uBAAO;AACHA,6BAAS3C,EAAE4C,GAAF,CAAMR,IAAN,EAAY,UAAUS,GAAV,EAAe;AAChC,+BAAO,EAACxB,IAAIwB,IAAIxB,EAAT,EAAaO,MAAMiB,IAAIN,IAAvB,EAAP;AACH,qBAFQ;AADN,iBAAP;AAKH,aAxBC;AAyBFO,mBAAO;AAzBL;AAFiB,KAA3B;AA+BH,CArED","file":"add.js","sourcesContent":["$(function () {\r\n\r\n    $('[data-created]').submit(function (event) {\r\n\r\n        event.preventDefault();\r\n\r\n        let $self = $(this);\r\n        let form = new FormData(this);\r\n\r\n        fetch($self.attr('action'), {\r\n            method: $self.attr('method'),\r\n            credentials: 'include',\r\n            body: form\r\n        }).then(function (response) {\r\n            if (response.status === 201 || response.status === 200) {\r\n                return response.json();\r\n            }\r\n\r\n            let error = new Error(response.statusText);\r\n            error.response = response;\r\n            throw error;\r\n        }).then(function (json) {\r\n\r\n            location.href = '/cp/sow/collection/edit/' + json.id;\r\n\r\n        }).catch(function (error) {\r\n            let $message = $self.find('.alert');\r\n\r\n            if (!$message.length) {\r\n                $self.find('div:first-child').prepend('<div class=\"alert\"></div>');\r\n                $message = $self.find('.alert');\r\n            }\r\n\r\n            error.response.json().then((json) => $message.addClass('alert-danger').text(json.message));\r\n        });\r\n\r\n    });\r\n\r\n    $('#brandsSelect').select2({\r\n        theme: \"bootstrap\",\r\n        ajax: {\r\n            url: '/api/soc/brand?limit=15',\r\n            dataType: 'json',\r\n            delay: 350,\r\n            data: function (params) {\r\n                return {\r\n                    queries: {\r\n                        name: params.term\r\n                    },\r\n                    page: params.page || 1\r\n                }\r\n            },\r\n            processResults: function (data) {\r\n                if (typeof data.message !== \"undefined\") {\r\n                    return {\r\n                        results: {}\r\n                    };\r\n                }\r\n\r\n                return {\r\n                    results: $.map(data, function (obj) {\r\n                        return {id: obj.id, text: obj.name};\r\n                    })\r\n                };\r\n            },\r\n            cache: true\r\n        }\r\n    });\r\n\r\n});"]}